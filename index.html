<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover"/>
  <title>Ambiente Espiritual - Capa</title>
  <link rel="manifest" href="./manifest.json">
  <meta name="theme-color" content="#1A2238">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="apple-mobile-web-app-title" content="Ambiente Espiritual">
  <link rel="stylesheet" href="./design-tokens.css">
</head>
<body style="margin: 0; padding: 0; background: var(--c-bg-areia);">
  <!-- CAPA IMERSIVA EM TELA CHEIA -->
  <main class="pwa-home-cover">
    
    <!-- Parte Superior: T√≠tulos e Tag -->
    <div class="cover-header">
      <p class="cover-tag">Guia de Estudo</p>
      <h1 class="cover-title">Ambiente<br>Espiritual</h1>
      <p class="cover-subtitle">Arrume a Casa para Deus Entrar</p>
    </div>

    <!-- Parte Inferior: A√ß√µes Flutuantes -->
    <div class="cover-actions">
      <p class="cover-desc">
        Um programa pr√°tico de 5 etapas para transformar seu espa√ßo e sua rotina em um santu√°rio de ora√ß√£o.
      </p>
      
      <!-- Bot√£o Principal: Iniciar Tutorial -->
      <a href="./parte-2.html" class="btn btn-iniciar">
        Iniciar Tutorial <span class="arrow">‚ûî</span>
      </a>

      <!-- Bot√µes Secund√°rios: Checklist e Wallpapers (Glassmorphism) -->
      <div class="home-action-buttons">
        <a href="./checklist.html" class="action-btn-glass">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M9 11l3 3L22 4M11 20H7c-1.1 0-2-.9-2-2V5c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2v11" stroke="currentColor" stroke-width="2" fill="none"/>
          </svg>
          <span>Checklist</span>
        </a>
        
        <a href="./wallpapers.html" class="action-btn-glass">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor">
            <path d="M21 19V5c0-1.1-.9-2-2-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2zM8.5 13.5l2.5 3.01L14.5 12l4.5 6H5l3.5-4.5z"/>
          </svg>
          <span>Wallpapers</span>
        </a>
      </div>
    </div>

  </main>

  <script>
    // üßπ LIMPEZA AGRESSIVA: Cache + localStorage + dados antigos
    (async function aggressiveClearup() {
      console.log('üßπ == INICIANDO LIMPEZA AGRESSIVA v4 == üßπ');
      
      try {
        const cacheNames = await caches.keys();
        console.log('üì¶ Caches encontrados:', cacheNames);
        
        for (const name of cacheNames) {
          if (name !== 'ambiente-espiritual-v4') {
            console.log('üóëÔ∏è Deletando cache:', name);
            await caches.delete(name);
          }
        }
        console.log('‚úÖ Todos os caches antigos removidos!');
      } catch (error) {
        console.error('‚ùå Erro ao limpar cache:', error);
      }
      
      try {
        const keysToRemove = [];
        for (let i = 0; i < localStorage.length; i++) {
          const key = localStorage.key(i);
          if (key !== 'ambiente-espiritual-checklist') {
            keysToRemove.push(key);
          }
        }
        
        keysToRemove.forEach(key => {
          console.log('üóëÔ∏è Removendo localStorage:', key);
          localStorage.removeItem(key);
        });
        
        if (keysToRemove.length > 0) {
          console.log('‚úÖ localStorage limpo:', keysToRemove.length, 'itens removidos');
        }
      } catch (error) {
        console.error('‚ùå Erro ao limpar localStorage:', error);
      }
      
      try {
        if (window.indexedDB) {
          const dbs = await indexedDB.databases?.() || [];
          dbs.forEach(db => {
            if (db.name.includes('ambiente')) {
              indexedDB.deleteDatabase(db.name);
              console.log('üóëÔ∏è Deletando IndexedDB:', db.name);
            }
          });
        }
      } catch (error) {
        console.log('‚ÑπÔ∏è IndexedDB cleanup n√£o ativado:', error.message);
      }
      
      console.log('‚ú® == LIMPEZA v4 CONCLU√çDA == ‚ú®');
    })();

    // Registrar Service Worker
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.addEventListener('message', (event) => {
        if (event.data.type === 'CACHE_CLEARED') {
          console.log('üì¢ Service Worker:', event.data.message);
        }
      });
      
      window.addEventListener('load', function () {
        navigator.serviceWorker.register('./service-worker.js')
          .then(reg => {
            console.log('‚úÖ Service Worker v4 registrado');
            setInterval(() => {
              console.log('üîÑ Verificando atualiza√ß√µes...');
              reg.update();
            }, 1 * 60 * 1000);
            reg.update();
          })
          .catch(err => console.error('‚ùå Erro no Service Worker:', err));
      });
    }
  </script>
</body>
</html>

